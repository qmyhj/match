2020-05-25 11:17:28,650 Model(
  (ad_id_embedding): Embedding(579847, 256, padding_idx=0)
  (product_id_embedding): Embedding(11108, 256, padding_idx=0)
  (advertiser_id_embedding): Embedding(24366, 256, padding_idx=0)
  (industry_embedding): Embedding(302, 16, padding_idx=0)
  (position_embedding): Embedding(80, 16)
  (encoder): Encoder(
    (attention): MultiHeadAttention(
      (fc_Q): Linear(in_features=800, out_features=800, bias=True)
      (fc_K): Linear(in_features=800, out_features=800, bias=True)
      (fc_V): Linear(in_features=800, out_features=800, bias=True)
      (fc): Linear(in_features=800, out_features=800, bias=True)
      (dropout): Dropout(p=0.1)
      (layer_norm): LayerNorm(torch.Size([800]), eps=1e-05, elementwise_affine=True)
    )
  )
  (fc): Sequential(
    (0): Linear(in_features=64000, out_features=1024, bias=True)
    (1): LeakyReLU(negative_slope=0.01, inplace)
    (2): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): Linear(in_features=1024, out_features=128, bias=True)
    (4): LeakyReLU(negative_slope=0.01, inplace)
    (5): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Linear(in_features=128, out_features=10, bias=True)
  )
)
2020-05-25 11:17:41,102 start loading data ...
2020-05-25 11:19:12,740 load data success, Time usage: 0:01:32
2020-05-25 11:19:12,743 Epoch [1/5]
2020-05-25 11:19:30,049 Iter:      0,  Train Loss:  2.66,  Train Acc: 10.94%,  Val Loss:  6.11,  Val Acc: 16.11%,  Val Auc:    0.0,  Time: 0:00:17 *
2020-05-25 11:19:51,707 Iter:    100,  Train Loss:  1.83,  Train Acc: 31.25%,  Val Loss:  1.89,  Val Acc: 28.76%,  Val Auc:    0.0,  Time: 0:00:39 *
2020-05-25 11:20:13,895 Iter:    200,  Train Loss:  1.76,  Train Acc: 31.25%,  Val Loss:  1.71,  Val Acc: 32.21%,  Val Auc:    0.0,  Time: 0:01:01 *
2020-05-25 11:20:35,856 Iter:    300,  Train Loss:  1.77,  Train Acc: 27.34%,  Val Loss:  1.65,  Val Acc: 33.58%,  Val Auc:    0.0,  Time: 0:01:23 *
2020-05-25 11:20:57,653 Iter:    400,  Train Loss:  1.58,  Train Acc: 34.38%,  Val Loss:   1.6,  Val Acc: 35.43%,  Val Auc:    0.0,  Time: 0:01:45 *
2020-05-25 11:21:24,458 Iter:    500,  Train Loss:  1.58,  Train Acc: 38.28%,  Val Loss:  1.57,  Val Acc: 36.22%,  Val Auc:    0.0,  Time: 0:02:12 *
2020-05-25 11:21:46,558 Iter:    600,  Train Loss:  1.54,  Train Acc: 38.28%,  Val Loss:  1.54,  Val Acc: 37.31%,  Val Auc:    0.0,  Time: 0:02:34 *
2020-05-25 11:22:08,540 Iter:    700,  Train Loss:   1.5,  Train Acc: 36.72%,  Val Loss:  1.53,  Val Acc: 37.06%,  Val Auc:    0.0,  Time: 0:02:56 *
2020-05-25 11:22:30,332 Iter:    800,  Train Loss:  1.59,  Train Acc: 34.38%,  Val Loss:   1.5,  Val Acc: 38.68%,  Val Auc:    0.0,  Time: 0:03:18 *
2020-05-25 11:22:52,005 Iter:    900,  Train Loss:  1.46,  Train Acc: 35.94%,  Val Loss:  1.49,  Val Acc: 39.03%,  Val Auc:    0.0,  Time: 0:03:39 *
2020-05-25 11:23:13,667 Iter:   1000,  Train Loss:  1.48,  Train Acc: 39.06%,  Val Loss:  1.48,  Val Acc: 39.25%,  Val Auc:    0.0,  Time: 0:04:01 *
2020-05-25 11:23:35,371 Iter:   1100,  Train Loss:  1.43,  Train Acc: 39.06%,  Val Loss:  1.48,  Val Acc: 39.59%,  Val Auc:    0.0,  Time: 0:04:23 *
2020-05-25 11:23:57,063 Iter:   1200,  Train Loss:  1.42,  Train Acc: 44.53%,  Val Loss:  1.46,  Val Acc: 40.22%,  Val Auc:    0.0,  Time: 0:04:44 *
2020-05-25 11:24:18,898 Iter:   1300,  Train Loss:  1.36,  Train Acc: 41.41%,  Val Loss:  1.45,  Val Acc: 41.06%,  Val Auc:    0.0,  Time: 0:05:06 *
2020-05-25 11:24:35,900 Iter:   1400,  Train Loss:  1.49,  Train Acc: 41.41%,  Val Loss:  1.46,  Val Acc: 40.81%,  Val Auc:    0.0,  Time: 0:05:23 
2020-05-25 11:24:57,732 Iter:   1500,  Train Loss:  1.44,  Train Acc: 45.31%,  Val Loss:  1.45,  Val Acc: 41.19%,  Val Auc:    0.0,  Time: 0:05:45 *
2020-05-25 11:25:19,643 Iter:   1600,  Train Loss:  1.58,  Train Acc: 35.94%,  Val Loss:  1.44,  Val Acc: 41.04%,  Val Auc:    0.0,  Time: 0:06:07 *
2020-05-25 11:25:41,802 Iter:   1700,  Train Loss:  1.38,  Train Acc: 48.44%,  Val Loss:  1.43,  Val Acc: 41.59%,  Val Auc:    0.0,  Time: 0:06:29 *
2020-05-25 11:26:03,532 Iter:   1800,  Train Loss:  1.38,  Train Acc: 40.62%,  Val Loss:  1.43,  Val Acc: 41.61%,  Val Auc:    0.0,  Time: 0:06:51 *
2020-05-25 11:26:25,736 Iter:   1900,  Train Loss:  1.51,  Train Acc: 42.97%,  Val Loss:  1.43,  Val Acc: 41.82%,  Val Auc:    0.0,  Time: 0:07:13 *
2020-05-25 11:26:48,008 Iter:   2000,  Train Loss:  1.34,  Train Acc: 46.09%,  Val Loss:  1.42,  Val Acc: 42.16%,  Val Auc:    0.0,  Time: 0:07:35 *
2020-05-25 11:27:05,296 Iter:   2100,  Train Loss:   1.4,  Train Acc: 37.50%,  Val Loss:  1.42,  Val Acc: 41.55%,  Val Auc:    0.0,  Time: 0:07:53 
2020-05-25 11:27:27,652 Iter:   2200,  Train Loss:  1.41,  Train Acc: 38.28%,  Val Loss:  1.41,  Val Acc: 42.03%,  Val Auc:    0.0,  Time: 0:08:15 *
2020-05-25 11:27:49,573 Iter:   2300,  Train Loss:  1.44,  Train Acc: 42.19%,  Val Loss:  1.41,  Val Acc: 42.06%,  Val Auc:    0.0,  Time: 0:08:37 *
2020-05-25 11:28:11,547 Iter:   2400,  Train Loss:  1.31,  Train Acc: 50.00%,  Val Loss:   1.4,  Val Acc: 42.88%,  Val Auc:    0.0,  Time: 0:08:59 *
2020-05-25 11:28:28,510 Iter:   2500,  Train Loss:  1.36,  Train Acc: 49.22%,  Val Loss:  1.41,  Val Acc: 42.05%,  Val Auc:    0.0,  Time: 0:09:16 
2020-05-25 11:28:50,383 Iter:   2600,  Train Loss:  1.38,  Train Acc: 44.53%,  Val Loss:   1.4,  Val Acc: 42.75%,  Val Auc:    0.0,  Time: 0:09:38 *
2020-05-25 11:29:07,593 Iter:   2700,  Train Loss:  1.58,  Train Acc: 30.47%,  Val Loss:   1.4,  Val Acc: 42.58%,  Val Auc:    0.0,  Time: 0:09:55 
2020-05-25 11:29:24,531 Iter:   2800,  Train Loss:  1.48,  Train Acc: 41.41%,  Val Loss:   1.4,  Val Acc: 42.87%,  Val Auc:    0.0,  Time: 0:10:12 
2020-05-25 11:29:45,989 Iter:   2900,  Train Loss:  1.45,  Train Acc: 38.28%,  Val Loss:  1.39,  Val Acc: 43.16%,  Val Auc:    0.0,  Time: 0:10:33 *
2020-05-25 11:30:07,784 Iter:   3000,  Train Loss:  1.27,  Train Acc: 47.66%,  Val Loss:  1.39,  Val Acc: 43.05%,  Val Auc:    0.0,  Time: 0:10:55 *
2020-05-25 11:30:25,056 Iter:   3100,  Train Loss:  1.44,  Train Acc: 38.28%,  Val Loss:  1.39,  Val Acc: 43.21%,  Val Auc:    0.0,  Time: 0:11:12 
2020-05-25 11:30:46,328 Iter:   3200,  Train Loss:  1.39,  Train Acc: 46.09%,  Val Loss:  1.38,  Val Acc: 43.47%,  Val Auc:    0.0,  Time: 0:11:34 *
2020-05-25 11:31:03,342 Iter:   3300,  Train Loss:   1.4,  Train Acc: 43.75%,  Val Loss:  1.39,  Val Acc: 43.42%,  Val Auc:    0.0,  Time: 0:11:51 
2020-05-25 11:31:20,310 Iter:   3400,  Train Loss:  1.35,  Train Acc: 46.88%,  Val Loss:  1.38,  Val Acc: 43.53%,  Val Auc:    0.0,  Time: 0:12:08 
2020-05-25 11:31:42,145 Iter:   3500,  Train Loss:  1.26,  Train Acc: 47.66%,  Val Loss:  1.38,  Val Acc: 43.54%,  Val Auc:    0.0,  Time: 0:12:29 *
2020-05-25 11:32:03,959 Iter:   3600,  Train Loss:  1.36,  Train Acc: 49.22%,  Val Loss:  1.38,  Val Acc: 43.61%,  Val Auc:    0.0,  Time: 0:12:51 *
2020-05-25 11:32:21,128 Iter:   3700,  Train Loss:  1.34,  Train Acc: 42.19%,  Val Loss:  1.38,  Val Acc: 43.52%,  Val Auc:    0.0,  Time: 0:13:08 
2020-05-25 11:32:43,230 Iter:   3800,  Train Loss:  1.41,  Train Acc: 41.41%,  Val Loss:  1.37,  Val Acc: 43.73%,  Val Auc:    0.0,  Time: 0:13:30 *
2020-05-25 11:33:00,452 Iter:   3900,  Train Loss:  1.31,  Train Acc: 46.88%,  Val Loss:  1.37,  Val Acc: 43.56%,  Val Auc:    0.0,  Time: 0:13:48 
2020-05-25 11:33:22,565 Iter:   4000,  Train Loss:  1.32,  Train Acc: 42.19%,  Val Loss:  1.37,  Val Acc: 43.77%,  Val Auc:    0.0,  Time: 0:14:10 *
2020-05-25 11:33:45,101 Iter:   4100,  Train Loss:  1.39,  Train Acc: 44.53%,  Val Loss:  1.37,  Val Acc: 43.89%,  Val Auc:    0.0,  Time: 0:14:32 
2020-05-25 11:34:07,619 Iter:   4200,  Train Loss:  1.35,  Train Acc: 56.25%,  Val Loss:  1.37,  Val Acc: 43.87%,  Val Auc:    0.0,  Time: 0:14:55 *
2020-05-25 11:34:29,471 Iter:   4300,  Train Loss:  1.54,  Train Acc: 37.50%,  Val Loss:  1.37,  Val Acc: 44.03%,  Val Auc:    0.0,  Time: 0:15:17 *
2020-05-25 11:34:51,029 Iter:   4400,  Train Loss:  1.53,  Train Acc: 42.19%,  Val Loss:  1.36,  Val Acc: 43.87%,  Val Auc:    0.0,  Time: 0:15:38 *
2020-05-25 11:35:12,861 Iter:   4500,  Train Loss:  1.52,  Train Acc: 46.88%,  Val Loss:  1.36,  Val Acc: 44.06%,  Val Auc:    0.0,  Time: 0:16:00 *
2020-05-25 11:35:29,965 Iter:   4600,  Train Loss:  1.34,  Train Acc: 46.09%,  Val Loss:  1.38,  Val Acc: 43.59%,  Val Auc:    0.0,  Time: 0:16:17 
2020-05-25 11:35:51,643 Iter:   4700,  Train Loss:  1.41,  Train Acc: 43.75%,  Val Loss:  1.36,  Val Acc: 44.33%,  Val Auc:    0.0,  Time: 0:16:39 *
2020-05-25 11:36:13,455 Iter:   4800,  Train Loss:  1.42,  Train Acc: 43.75%,  Val Loss:  1.36,  Val Acc: 44.43%,  Val Auc:    0.0,  Time: 0:17:01 *
2020-05-25 11:36:30,754 Iter:   4900,  Train Loss:   1.4,  Train Acc: 42.97%,  Val Loss:  1.36,  Val Acc: 44.41%,  Val Auc:    0.0,  Time: 0:17:18 
2020-05-25 11:36:47,572 Iter:   5000,  Train Loss:  1.45,  Train Acc: 40.62%,  Val Loss:  1.36,  Val Acc: 44.57%,  Val Auc:    0.0,  Time: 0:17:35 
2020-05-25 11:37:04,549 Iter:   5100,  Train Loss:  1.35,  Train Acc: 42.97%,  Val Loss:  1.36,  Val Acc: 44.57%,  Val Auc:    0.0,  Time: 0:17:52 
2020-05-25 11:37:26,665 Iter:   5200,  Train Loss:  1.35,  Train Acc: 44.53%,  Val Loss:  1.35,  Val Acc: 44.82%,  Val Auc:    0.0,  Time: 0:18:14 *
2020-05-25 11:37:48,662 Iter:   5300,  Train Loss:  1.38,  Train Acc: 38.28%,  Val Loss:  1.35,  Val Acc: 44.80%,  Val Auc:    0.0,  Time: 0:18:36 *
2020-05-25 11:38:05,853 Iter:   5400,  Train Loss:  1.27,  Train Acc: 50.00%,  Val Loss:  1.35,  Val Acc: 44.57%,  Val Auc:    0.0,  Time: 0:18:53 
2020-05-25 11:38:22,889 Iter:   5500,  Train Loss:  1.36,  Train Acc: 43.75%,  Val Loss:  1.35,  Val Acc: 44.43%,  Val Auc:    0.0,  Time: 0:19:10 
2020-05-25 11:38:39,903 Iter:   5600,  Train Loss:   1.4,  Train Acc: 45.31%,  Val Loss:  1.35,  Val Acc: 44.30%,  Val Auc:    0.0,  Time: 0:19:27 
2020-05-25 11:39:01,721 Iter:   5700,  Train Loss:  1.22,  Train Acc: 50.78%,  Val Loss:  1.35,  Val Acc: 44.58%,  Val Auc:    0.0,  Time: 0:19:49 *
2020-05-25 11:39:23,695 Iter:   5800,  Train Loss:  1.41,  Train Acc: 43.75%,  Val Loss:  1.35,  Val Acc: 44.88%,  Val Auc:    0.0,  Time: 0:20:11 *
2020-05-25 11:39:45,824 Iter:   5900,  Train Loss:  1.28,  Train Acc: 45.31%,  Val Loss:  1.34,  Val Acc: 45.35%,  Val Auc:    0.0,  Time: 0:20:33 *
2020-05-25 11:40:03,019 Iter:   6000,  Train Loss:   1.5,  Train Acc: 37.50%,  Val Loss:  1.34,  Val Acc: 44.95%,  Val Auc:    0.0,  Time: 0:20:50 
2020-05-25 11:40:25,146 Iter:   6100,  Train Loss:  1.27,  Train Acc: 52.34%,  Val Loss:  1.34,  Val Acc: 45.45%,  Val Auc:    0.0,  Time: 0:21:12 *
2020-05-25 11:40:42,281 Iter:   6200,  Train Loss:  1.31,  Train Acc: 51.56%,  Val Loss:  1.34,  Val Acc: 45.01%,  Val Auc:    0.0,  Time: 0:21:30 
2020-05-25 11:40:59,110 Iter:   6300,  Train Loss:  1.27,  Train Acc: 43.75%,  Val Loss:  1.34,  Val Acc: 45.05%,  Val Auc:    0.0,  Time: 0:21:46 
2020-05-25 11:41:01,715 Epoch [2/5]
2020-05-25 11:41:17,091 Iter:   6400,  Train Loss: 0.991,  Train Acc: 62.50%,  Val Loss:  1.41,  Val Acc: 44.29%,  Val Auc:    0.0,  Time: 0:22:04 
2020-05-25 11:41:34,086 Iter:   6500,  Train Loss:  1.14,  Train Acc: 49.22%,  Val Loss:  1.44,  Val Acc: 43.90%,  Val Auc:    0.0,  Time: 0:22:21 
2020-05-25 11:41:51,184 Iter:   6600,  Train Loss:  1.16,  Train Acc: 52.34%,  Val Loss:  1.47,  Val Acc: 43.79%,  Val Auc:    0.0,  Time: 0:22:38 
2020-05-25 11:42:08,206 Iter:   6700,  Train Loss:  1.06,  Train Acc: 52.34%,  Val Loss:  1.48,  Val Acc: 43.60%,  Val Auc:    0.0,  Time: 0:22:55 
2020-05-25 11:42:25,387 Iter:   6800,  Train Loss:  1.08,  Train Acc: 56.25%,  Val Loss:  1.48,  Val Acc: 43.28%,  Val Auc:    0.0,  Time: 0:23:13 
2020-05-25 11:42:42,477 Iter:   6900,  Train Loss:  1.08,  Train Acc: 56.25%,  Val Loss:  1.49,  Val Acc: 42.84%,  Val Auc:    0.0,  Time: 0:23:30 
2020-05-25 11:42:59,390 Iter:   7000,  Train Loss:  1.14,  Train Acc: 49.22%,  Val Loss:  1.48,  Val Acc: 43.00%,  Val Auc:    0.0,  Time: 0:23:47 
2020-05-25 11:43:16,560 Iter:   7100,  Train Loss:   1.1,  Train Acc: 53.91%,  Val Loss:  1.49,  Val Acc: 42.54%,  Val Auc:    0.0,  Time: 0:24:04 
2020-05-25 11:43:33,582 Iter:   7200,  Train Loss:   1.1,  Train Acc: 48.44%,  Val Loss:  1.48,  Val Acc: 42.60%,  Val Auc:    0.0,  Time: 0:24:21 
2020-05-25 11:43:50,667 Iter:   7300,  Train Loss:  1.16,  Train Acc: 55.47%,  Val Loss:  1.48,  Val Acc: 42.89%,  Val Auc:    0.0,  Time: 0:24:38 
2020-05-25 11:44:07,675 Iter:   7400,  Train Loss:  1.05,  Train Acc: 56.25%,  Val Loss:  1.49,  Val Acc: 43.10%,  Val Auc:    0.0,  Time: 0:24:55 
2020-05-25 11:44:24,688 Iter:   7500,  Train Loss:  1.07,  Train Acc: 58.59%,  Val Loss:  1.48,  Val Acc: 43.19%,  Val Auc:    0.0,  Time: 0:25:12 
2020-05-25 11:44:41,653 Iter:   7600,  Train Loss:  1.05,  Train Acc: 64.06%,  Val Loss:  1.47,  Val Acc: 42.77%,  Val Auc:    0.0,  Time: 0:25:29 
2020-05-25 11:44:58,717 Iter:   7700,  Train Loss:  1.12,  Train Acc: 58.59%,  Val Loss:   1.5,  Val Acc: 43.10%,  Val Auc:    0.0,  Time: 0:25:46 
2020-05-25 11:45:15,826 Iter:   7800,  Train Loss:   1.1,  Train Acc: 53.91%,  Val Loss:   1.5,  Val Acc: 42.70%,  Val Auc:    0.0,  Time: 0:26:03 
2020-05-25 11:45:32,955 Iter:   7900,  Train Loss:  1.32,  Train Acc: 46.88%,  Val Loss:  1.49,  Val Acc: 43.29%,  Val Auc:    0.0,  Time: 0:26:20 
2020-05-25 11:45:50,082 Iter:   8000,  Train Loss:  1.13,  Train Acc: 53.12%,  Val Loss:  1.49,  Val Acc: 42.84%,  Val Auc:    0.0,  Time: 0:26:37 
2020-05-25 11:46:07,027 Iter:   8100,  Train Loss:  1.17,  Train Acc: 55.47%,  Val Loss:  1.48,  Val Acc: 42.83%,  Val Auc:    0.0,  Time: 0:26:54 
2020-05-25 11:46:07,027 No optimization for a long time, auto-stopping...
2020-05-25 11:46:20,920 Test Loss:   1.3,  Test Acc: 45.45%, Test Auc:    0.0
2020-05-25 11:46:20,920 Precision, Recall and F1-Score...
2020-05-25 11:46:20,920              precision    recall  f1-score   support

          0     0.7360    0.4824    0.5828      3543
          1     0.5996    0.6070    0.6033     15016
          2     0.4494    0.6155    0.5195     20342
          3     0.4501    0.3872    0.4163     14981
          4     0.3964    0.2613    0.3149     13125
          5     0.3410    0.4194    0.3761     10231
          6     0.3573    0.3096    0.3317      6492
          7     0.4126    0.2282    0.2938      3217
          8     0.3607    0.3380    0.3490      1926
          9     0.5039    0.5741    0.5367      1127

avg / total     0.4566    0.4545    0.4476     90000

2020-05-25 11:46:20,920 Confusion Matrix...
2020-05-25 11:46:20,920 [[ 1709  1222   399    44    30    56    51     7     8    17]
 [  373  9114  4663   321   181   190    72    21    35    46]
 [  108  3593 12521  2648   635   531   170    35    57    44]
 [   42   747  5535  5801  1604   863   246    34    65    44]
 [   19   273  2613  2652  3429  3286   615    72   105    61]
 [   28   142  1149   928  2086  4291  1301   125   125    56]
 [   24    71   550   327   547  2384  2010   357   176    46]
 [   13    24   229   103   106   641   907   734   359   101]
 [    5    10   136    45    27   258   208   364   651   222]
 [    1     3    65    20     6    85    46    30   224   647]]
2020-05-25 11:46:20,921 Time usage: 0:00:11
2020-05-25 11:46:20,922 ALL Time usage: 0:28:40
