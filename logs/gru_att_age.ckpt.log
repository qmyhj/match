2020-05-25 13:19:34,349 Model(
  (ad_id_embedding): Embedding(579847, 256, padding_idx=0)
  (product_id_embedding): Embedding(11108, 256, padding_idx=0)
  (product_category_embedding): Embedding(20, 8, padding_idx=0)
  (advertiser_id_embedding): Embedding(24366, 256, padding_idx=0)
  (industry_embedding): Embedding(302, 32, padding_idx=0)
  (gru): GRU(808, 128, batch_first=True, bidirectional=True)
  (fc): Sequential(
    (0): Dropout(p=0.2)
    (1): Linear(in_features=256, out_features=128, bias=True)
    (2): LeakyReLU(negative_slope=0.01, inplace)
    (3): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Linear(in_features=128, out_features=64, bias=True)
    (5): LeakyReLU(negative_slope=0.01, inplace)
    (6): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): Linear(in_features=64, out_features=10, bias=True)
  )
)
2020-05-25 13:19:42,859 start loading data ...
2020-05-25 13:21:21,281 load data success, Time usage: 0:01:38
2020-05-25 13:21:21,283 Epoch [1/5]
2020-05-25 13:21:35,425 Iter:      0,  Train Loss:   2.5,  Train Acc: 16.41%,  Val Loss:  2.31,  Val Acc:  4.01%,  Val Auc:    0.0,  Time: 0:00:14 *
2020-05-25 13:21:52,896 Iter:    100,  Train Loss:   1.9,  Train Acc: 27.34%,  Val Loss:  1.91,  Val Acc: 27.22%,  Val Auc:    0.0,  Time: 0:00:32 *
2020-05-25 13:22:10,315 Iter:    200,  Train Loss:  1.66,  Train Acc: 34.38%,  Val Loss:  1.69,  Val Acc: 32.79%,  Val Auc:    0.0,  Time: 0:00:49 *
2020-05-25 13:22:27,785 Iter:    300,  Train Loss:  1.75,  Train Acc: 26.56%,  Val Loss:  1.61,  Val Acc: 34.88%,  Val Auc:    0.0,  Time: 0:01:07 *
2020-05-25 13:22:44,519 Iter:    400,  Train Loss:  1.52,  Train Acc: 31.25%,  Val Loss:  1.56,  Val Acc: 36.83%,  Val Auc:    0.0,  Time: 0:01:23 *
2020-05-25 13:23:01,537 Iter:    500,  Train Loss:  1.51,  Train Acc: 33.59%,  Val Loss:  1.54,  Val Acc: 37.52%,  Val Auc:    0.0,  Time: 0:01:40 *
2020-05-25 13:23:19,081 Iter:    600,  Train Loss:  1.55,  Train Acc: 41.41%,  Val Loss:  1.52,  Val Acc: 38.31%,  Val Auc:    0.0,  Time: 0:01:58 *
2020-05-25 13:23:33,447 Iter:    700,  Train Loss:  1.47,  Train Acc: 39.84%,  Val Loss:  1.53,  Val Acc: 38.38%,  Val Auc:    0.0,  Time: 0:02:12 
2020-05-25 13:23:50,212 Iter:    800,  Train Loss:  1.66,  Train Acc: 29.69%,  Val Loss:  1.49,  Val Acc: 39.09%,  Val Auc:    0.0,  Time: 0:02:29 *
2020-05-25 13:24:08,401 Iter:    900,  Train Loss:   1.5,  Train Acc: 38.28%,  Val Loss:  1.48,  Val Acc: 39.68%,  Val Auc:    0.0,  Time: 0:02:47 *
2020-05-25 13:24:25,709 Iter:   1000,  Train Loss:  1.47,  Train Acc: 39.84%,  Val Loss:  1.47,  Val Acc: 40.11%,  Val Auc:    0.0,  Time: 0:03:04 *
2020-05-25 13:24:42,787 Iter:   1100,  Train Loss:  1.47,  Train Acc: 40.62%,  Val Loss:  1.46,  Val Acc: 40.91%,  Val Auc:    0.0,  Time: 0:03:22 *
2020-05-25 13:24:59,868 Iter:   1200,  Train Loss:  1.42,  Train Acc: 39.84%,  Val Loss:  1.45,  Val Acc: 41.07%,  Val Auc:    0.0,  Time: 0:03:39 *
2020-05-25 13:25:14,971 Iter:   1300,  Train Loss:  1.38,  Train Acc: 46.88%,  Val Loss:  1.46,  Val Acc: 40.79%,  Val Auc:    0.0,  Time: 0:03:54 
2020-05-25 13:25:32,156 Iter:   1400,  Train Loss:  1.44,  Train Acc: 39.84%,  Val Loss:  1.44,  Val Acc: 41.41%,  Val Auc:    0.0,  Time: 0:04:11 *
2020-05-25 13:25:49,540 Iter:   1500,  Train Loss:  1.46,  Train Acc: 39.84%,  Val Loss:  1.43,  Val Acc: 41.82%,  Val Auc:    0.0,  Time: 0:04:28 *
2020-05-25 13:26:07,153 Iter:   1600,  Train Loss:  1.55,  Train Acc: 43.75%,  Val Loss:  1.43,  Val Acc: 41.86%,  Val Auc:    0.0,  Time: 0:04:46 *
2020-05-25 13:26:24,353 Iter:   1700,  Train Loss:  1.37,  Train Acc: 48.44%,  Val Loss:  1.43,  Val Acc: 41.95%,  Val Auc:    0.0,  Time: 0:05:03 *
2020-05-25 13:26:41,664 Iter:   1800,  Train Loss:  1.42,  Train Acc: 42.97%,  Val Loss:  1.42,  Val Acc: 42.07%,  Val Auc:    0.0,  Time: 0:05:20 *
2020-05-25 13:26:55,847 Iter:   1900,  Train Loss:  1.48,  Train Acc: 44.53%,  Val Loss:  1.42,  Val Acc: 42.27%,  Val Auc:    0.0,  Time: 0:05:35 
2020-05-25 13:27:12,839 Iter:   2000,  Train Loss:  1.38,  Train Acc: 35.94%,  Val Loss:  1.41,  Val Acc: 42.47%,  Val Auc:    0.0,  Time: 0:05:52 *
2020-05-25 13:27:30,333 Iter:   2100,  Train Loss:  1.38,  Train Acc: 39.84%,  Val Loss:  1.41,  Val Acc: 42.67%,  Val Auc:    0.0,  Time: 0:06:09 *
2020-05-25 13:27:47,192 Iter:   2200,  Train Loss:   1.4,  Train Acc: 43.75%,  Val Loss:   1.4,  Val Acc: 42.61%,  Val Auc:    0.0,  Time: 0:06:26 *
2020-05-25 13:28:03,828 Iter:   2300,  Train Loss:  1.42,  Train Acc: 44.53%,  Val Loss:   1.4,  Val Acc: 42.94%,  Val Auc:    0.0,  Time: 0:06:43 *
2020-05-25 13:28:21,228 Iter:   2400,  Train Loss:  1.29,  Train Acc: 50.78%,  Val Loss:  1.39,  Val Acc: 43.12%,  Val Auc:    0.0,  Time: 0:07:00 *
2020-05-25 13:28:35,480 Iter:   2500,  Train Loss:  1.36,  Train Acc: 48.44%,  Val Loss:  1.39,  Val Acc: 42.90%,  Val Auc:    0.0,  Time: 0:07:14 
2020-05-25 13:28:52,032 Iter:   2600,  Train Loss:  1.35,  Train Acc: 43.75%,  Val Loss:  1.39,  Val Acc: 43.33%,  Val Auc:    0.0,  Time: 0:07:31 *
2020-05-25 13:29:06,352 Iter:   2700,  Train Loss:  1.54,  Train Acc: 34.38%,  Val Loss:  1.39,  Val Acc: 43.15%,  Val Auc:    0.0,  Time: 0:07:45 
2020-05-25 13:29:20,493 Iter:   2800,  Train Loss:  1.49,  Train Acc: 37.50%,  Val Loss:  1.39,  Val Acc: 43.65%,  Val Auc:    0.0,  Time: 0:07:59 
2020-05-25 13:29:37,378 Iter:   2900,  Train Loss:  1.43,  Train Acc: 42.19%,  Val Loss:  1.38,  Val Acc: 43.49%,  Val Auc:    0.0,  Time: 0:08:16 *
2020-05-25 13:29:54,469 Iter:   3000,  Train Loss:  1.25,  Train Acc: 46.88%,  Val Loss:  1.38,  Val Acc: 43.89%,  Val Auc:    0.0,  Time: 0:08:33 *
2020-05-25 13:30:11,838 Iter:   3100,  Train Loss:  1.42,  Train Acc: 36.72%,  Val Loss:  1.37,  Val Acc: 43.95%,  Val Auc:    0.0,  Time: 0:08:51 *
2020-05-25 13:30:26,432 Iter:   3200,  Train Loss:  1.37,  Train Acc: 42.97%,  Val Loss:  1.38,  Val Acc: 44.02%,  Val Auc:    0.0,  Time: 0:09:05 
2020-05-25 13:30:43,218 Iter:   3300,  Train Loss:   1.4,  Train Acc: 41.41%,  Val Loss:  1.37,  Val Acc: 43.93%,  Val Auc:    0.0,  Time: 0:09:22 *
2020-05-25 13:31:00,566 Iter:   3400,  Train Loss:  1.36,  Train Acc: 42.97%,  Val Loss:  1.37,  Val Acc: 44.24%,  Val Auc:    0.0,  Time: 0:09:39 *
2020-05-25 13:31:18,102 Iter:   3500,  Train Loss:  1.23,  Train Acc: 49.22%,  Val Loss:  1.37,  Val Acc: 44.26%,  Val Auc:    0.0,  Time: 0:09:57 *
2020-05-25 13:31:32,350 Iter:   3600,  Train Loss:  1.39,  Train Acc: 53.12%,  Val Loss:  1.37,  Val Acc: 44.16%,  Val Auc:    0.0,  Time: 0:10:11 
2020-05-25 13:31:46,390 Iter:   3700,  Train Loss:  1.33,  Train Acc: 40.62%,  Val Loss:  1.37,  Val Acc: 44.16%,  Val Auc:    0.0,  Time: 0:10:25 
2020-05-25 13:32:03,501 Iter:   3800,  Train Loss:  1.42,  Train Acc: 35.94%,  Val Loss:  1.36,  Val Acc: 44.23%,  Val Auc:    0.0,  Time: 0:10:42 *
2020-05-25 13:32:21,477 Iter:   3900,  Train Loss:  1.33,  Train Acc: 46.09%,  Val Loss:  1.36,  Val Acc: 44.40%,  Val Auc:    0.0,  Time: 0:11:00 *
2020-05-25 13:32:39,062 Iter:   4000,  Train Loss:  1.34,  Train Acc: 45.31%,  Val Loss:  1.36,  Val Acc: 44.52%,  Val Auc:    0.0,  Time: 0:11:18 *
2020-05-25 13:32:53,361 Iter:   4100,  Train Loss:  1.36,  Train Acc: 45.31%,  Val Loss:  1.36,  Val Acc: 44.45%,  Val Auc:    0.0,  Time: 0:11:32 
2020-05-25 13:33:10,585 Iter:   4200,  Train Loss:  1.36,  Train Acc: 53.12%,  Val Loss:  1.35,  Val Acc: 44.81%,  Val Auc:    0.0,  Time: 0:11:49 *
2020-05-25 13:33:25,554 Iter:   4300,  Train Loss:   1.6,  Train Acc: 38.28%,  Val Loss:  1.35,  Val Acc: 44.62%,  Val Auc:    0.0,  Time: 0:12:04 
2020-05-25 13:33:43,181 Iter:   4400,  Train Loss:  1.51,  Train Acc: 40.62%,  Val Loss:  1.35,  Val Acc: 44.64%,  Val Auc:    0.0,  Time: 0:12:22 *
2020-05-25 13:33:58,258 Iter:   4500,  Train Loss:  1.55,  Train Acc: 39.06%,  Val Loss:  1.35,  Val Acc: 44.42%,  Val Auc:    0.0,  Time: 0:12:37 
2020-05-25 13:34:13,330 Iter:   4600,  Train Loss:  1.35,  Train Acc: 42.19%,  Val Loss:  1.36,  Val Acc: 44.41%,  Val Auc:    0.0,  Time: 0:12:52 
2020-05-25 13:34:31,086 Iter:   4700,  Train Loss:  1.41,  Train Acc: 39.84%,  Val Loss:  1.34,  Val Acc: 45.14%,  Val Auc:    0.0,  Time: 0:13:10 *
2020-05-25 13:34:48,221 Iter:   4800,  Train Loss:  1.42,  Train Acc: 42.19%,  Val Loss:  1.34,  Val Acc: 44.87%,  Val Auc:    0.0,  Time: 0:13:27 *
2020-05-25 13:35:03,178 Iter:   4900,  Train Loss:  1.37,  Train Acc: 47.66%,  Val Loss:  1.34,  Val Acc: 44.96%,  Val Auc:    0.0,  Time: 0:13:42 
2020-05-25 13:35:20,380 Iter:   5000,  Train Loss:  1.43,  Train Acc: 39.06%,  Val Loss:  1.34,  Val Acc: 45.17%,  Val Auc:    0.0,  Time: 0:13:59 *
2020-05-25 13:35:34,603 Iter:   5100,  Train Loss:  1.35,  Train Acc: 40.62%,  Val Loss:  1.34,  Val Acc: 45.18%,  Val Auc:    0.0,  Time: 0:14:13 
2020-05-25 13:35:48,466 Iter:   5200,  Train Loss:  1.34,  Train Acc: 47.66%,  Val Loss:  1.34,  Val Acc: 45.21%,  Val Auc:    0.0,  Time: 0:14:27 
2020-05-25 13:36:05,258 Iter:   5300,  Train Loss:  1.38,  Train Acc: 45.31%,  Val Loss:  1.33,  Val Acc: 45.51%,  Val Auc:    0.0,  Time: 0:14:44 *
2020-05-25 13:36:19,735 Iter:   5400,  Train Loss:  1.24,  Train Acc: 53.91%,  Val Loss:  1.34,  Val Acc: 45.04%,  Val Auc:    0.0,  Time: 0:14:58 
2020-05-25 13:36:34,356 Iter:   5500,  Train Loss:  1.31,  Train Acc: 50.00%,  Val Loss:  1.34,  Val Acc: 45.17%,  Val Auc:    0.0,  Time: 0:15:13 
2020-05-25 13:36:48,737 Iter:   5600,  Train Loss:  1.32,  Train Acc: 49.22%,  Val Loss:  1.34,  Val Acc: 45.38%,  Val Auc:    0.0,  Time: 0:15:27 
2020-05-25 13:37:05,769 Iter:   5700,  Train Loss:  1.17,  Train Acc: 50.00%,  Val Loss:  1.33,  Val Acc: 45.15%,  Val Auc:    0.0,  Time: 0:15:44 *
2020-05-25 13:37:20,306 Iter:   5800,  Train Loss:  1.39,  Train Acc: 47.66%,  Val Loss:  1.34,  Val Acc: 45.45%,  Val Auc:    0.0,  Time: 0:15:59 
2020-05-25 13:37:37,655 Iter:   5900,  Train Loss:  1.26,  Train Acc: 50.78%,  Val Loss:  1.33,  Val Acc: 45.76%,  Val Auc:    0.0,  Time: 0:16:16 *
2020-05-25 13:37:54,994 Iter:   6000,  Train Loss:   1.5,  Train Acc: 40.62%,  Val Loss:  1.33,  Val Acc: 45.58%,  Val Auc:    0.0,  Time: 0:16:34 *
2020-05-25 13:38:13,474 Iter:   6100,  Train Loss:  1.31,  Train Acc: 50.78%,  Val Loss:  1.33,  Val Acc: 45.55%,  Val Auc:    0.0,  Time: 0:16:52 *
2020-05-25 13:38:31,585 Iter:   6200,  Train Loss:  1.31,  Train Acc: 45.31%,  Val Loss:  1.32,  Val Acc: 45.78%,  Val Auc:    0.0,  Time: 0:17:10 *
2020-05-25 13:38:49,448 Iter:   6300,  Train Loss:  1.29,  Train Acc: 41.41%,  Val Loss:  1.32,  Val Acc: 45.79%,  Val Auc:    0.0,  Time: 0:17:28 *
2020-05-25 13:38:51,856 Epoch [2/5]
2020-05-25 13:39:05,155 Iter:   6400,  Train Loss: 0.984,  Train Acc: 57.03%,  Val Loss:  1.36,  Val Acc: 45.16%,  Val Auc:    0.0,  Time: 0:17:44 
2020-05-25 13:39:19,506 Iter:   6500,  Train Loss:  1.06,  Train Acc: 51.56%,  Val Loss:  1.44,  Val Acc: 44.32%,  Val Auc:    0.0,  Time: 0:17:58 
2020-05-25 13:39:34,385 Iter:   6600,  Train Loss:  1.05,  Train Acc: 64.06%,  Val Loss:  1.42,  Val Acc: 44.29%,  Val Auc:    0.0,  Time: 0:18:13 
2020-05-25 13:39:48,374 Iter:   6700,  Train Loss:  1.08,  Train Acc: 54.69%,  Val Loss:  1.43,  Val Acc: 43.84%,  Val Auc:    0.0,  Time: 0:18:27 
2020-05-25 13:40:02,565 Iter:   6800,  Train Loss:  1.04,  Train Acc: 57.81%,  Val Loss:  1.47,  Val Acc: 43.07%,  Val Auc:    0.0,  Time: 0:18:41 
2020-05-25 13:40:17,286 Iter:   6900,  Train Loss:  1.02,  Train Acc: 65.62%,  Val Loss:  1.46,  Val Acc: 42.95%,  Val Auc:    0.0,  Time: 0:18:56 
2020-05-25 13:40:32,501 Iter:   7000,  Train Loss:  1.16,  Train Acc: 46.88%,  Val Loss:  1.47,  Val Acc: 42.73%,  Val Auc:    0.0,  Time: 0:19:11 
2020-05-25 13:40:47,846 Iter:   7100,  Train Loss:  1.05,  Train Acc: 53.12%,  Val Loss:  1.49,  Val Acc: 42.51%,  Val Auc:    0.0,  Time: 0:19:27 
2020-05-25 13:41:02,164 Iter:   7200,  Train Loss:  1.06,  Train Acc: 53.12%,  Val Loss:  1.46,  Val Acc: 42.89%,  Val Auc:    0.0,  Time: 0:19:41 
2020-05-25 13:41:16,945 Iter:   7300,  Train Loss:  1.21,  Train Acc: 57.81%,  Val Loss:  1.48,  Val Acc: 42.82%,  Val Auc:    0.0,  Time: 0:19:56 
2020-05-25 13:41:31,001 Iter:   7400,  Train Loss:  1.13,  Train Acc: 57.81%,  Val Loss:  1.49,  Val Acc: 42.68%,  Val Auc:    0.0,  Time: 0:20:10 
2020-05-25 13:41:45,196 Iter:   7500,  Train Loss:  1.03,  Train Acc: 55.47%,  Val Loss:   1.5,  Val Acc: 42.96%,  Val Auc:    0.0,  Time: 0:20:24 
2020-05-25 13:41:59,151 Iter:   7600,  Train Loss:  1.05,  Train Acc: 61.72%,  Val Loss:  1.47,  Val Acc: 42.63%,  Val Auc:    0.0,  Time: 0:20:38 
2020-05-25 13:42:14,451 Iter:   7700,  Train Loss:   1.1,  Train Acc: 57.81%,  Val Loss:  1.49,  Val Acc: 42.79%,  Val Auc:    0.0,  Time: 0:20:53 
2020-05-25 13:42:29,214 Iter:   7800,  Train Loss:  1.13,  Train Acc: 55.47%,  Val Loss:   1.5,  Val Acc: 42.36%,  Val Auc:    0.0,  Time: 0:21:08 
2020-05-25 13:42:43,390 Iter:   7900,  Train Loss:  1.26,  Train Acc: 49.22%,  Val Loss:  1.47,  Val Acc: 42.79%,  Val Auc:    0.0,  Time: 0:21:22 
2020-05-25 13:42:57,145 Iter:   8000,  Train Loss:  1.08,  Train Acc: 57.81%,  Val Loss:  1.47,  Val Acc: 42.59%,  Val Auc:    0.0,  Time: 0:21:36 
2020-05-25 13:43:11,294 Iter:   8100,  Train Loss:  1.23,  Train Acc: 54.69%,  Val Loss:   1.5,  Val Acc: 42.43%,  Val Auc:    0.0,  Time: 0:21:50 
2020-05-25 13:43:25,299 Iter:   8200,  Train Loss:  1.17,  Train Acc: 56.25%,  Val Loss:  1.47,  Val Acc: 42.29%,  Val Auc:    0.0,  Time: 0:22:04 
2020-05-25 13:43:39,043 Iter:   8300,  Train Loss:  1.05,  Train Acc: 59.38%,  Val Loss:  1.47,  Val Acc: 42.74%,  Val Auc:    0.0,  Time: 0:22:18 
2020-05-25 13:43:39,044 No optimization for a long time, auto-stopping...
2020-05-25 13:43:50,463 Test Loss:   1.3,  Test Acc: 45.79%, Test Auc:    0.0
2020-05-25 13:43:50,464 Precision, Recall and F1-Score...
2020-05-25 13:43:50,464              precision    recall  f1-score   support

          0     0.6834    0.5117    0.5852      3543
          1     0.6015    0.5775    0.5893     15016
          2     0.4772    0.6160    0.5378     20342
          3     0.4305    0.4301    0.4303     14981
          4     0.3537    0.2505    0.2933     13125
          5     0.3507    0.4561    0.3965     10231
          6     0.4080    0.2460    0.3069      6492
          7     0.3900    0.3074    0.3438      3217
          8     0.4255    0.2788    0.3369      1926
          9     0.4828    0.5963    0.5335      1127

avg / total     0.4567    0.4579    0.4507     90000

2020-05-25 13:43:50,464 Confusion Matrix...
2020-05-25 13:43:50,464 [[ 1813  1203   308    52    55    55    26    11     3    17]
 [  461  8672  4829   510   248   205    34    18    10    29]
 [  154  3176 12531  2914   875   500    80    45    29    38]
 [   60   712  5059  6443  1586   857   128    56    41    39]
 [   49   304  2038  3191  3288  3658   367   112    50    68]
 [   40   187   810  1176  2048  4666   933   236    59    76]
 [   42    93   386   413   785  2443  1597   578    94    61]
 [   22    39   154   163   229   611   609   989   291   110]
 [    7    22   103    69   114   225   126   441   537   282]
 [    5    10    39    35    69    85    14    50   148   672]]
2020-05-25 13:43:50,465 Time usage: 0:00:10
2020-05-25 13:43:50,465 ALL Time usage: 0:24:08
