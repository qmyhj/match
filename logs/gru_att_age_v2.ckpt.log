2020-05-25 13:49:53,796 Model(
  (ad_id_embedding): Embedding(579847, 256, padding_idx=0)
  (product_id_embedding): Embedding(11108, 256, padding_idx=0)
  (product_category_embedding): Embedding(20, 8, padding_idx=0)
  (advertiser_id_embedding): Embedding(24366, 256, padding_idx=0)
  (industry_embedding): Embedding(302, 32, padding_idx=0)
  (gru): GRU(808, 128, batch_first=True, bidirectional=True)
  (fc): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): LeakyReLU(negative_slope=0.01, inplace)
    (3): Linear(in_features=128, out_features=10, bias=True)
  )
)
2020-05-25 13:50:01,574 start loading data ...
2020-05-25 13:51:39,445 load data success, Time usage: 0:01:38
2020-05-25 13:51:39,446 Epoch [1/5]
2020-05-25 13:51:53,059 Iter:      0,  Train Loss:  2.53,  Train Acc:  8.59%,  Val Loss:  2.29,  Val Acc: 10.30%,  Val Auc:    0.0,  Time: 0:00:14 *
2020-05-25 13:52:10,293 Iter:    100,  Train Loss:   1.8,  Train Acc: 28.12%,  Val Loss:  1.76,  Val Acc: 30.48%,  Val Auc:    0.0,  Time: 0:00:31 *
2020-05-25 13:52:27,438 Iter:    200,  Train Loss:  1.54,  Train Acc: 32.81%,  Val Loss:  1.63,  Val Acc: 34.40%,  Val Auc:    0.0,  Time: 0:00:48 *
2020-05-25 13:52:44,629 Iter:    300,  Train Loss:   1.7,  Train Acc: 33.59%,  Val Loss:  1.58,  Val Acc: 35.72%,  Val Auc:    0.0,  Time: 0:01:05 *
2020-05-25 13:53:01,409 Iter:    400,  Train Loss:  1.56,  Train Acc: 38.28%,  Val Loss:  1.54,  Val Acc: 37.42%,  Val Auc:    0.0,  Time: 0:01:22 *
2020-05-25 13:53:19,303 Iter:    500,  Train Loss:  1.47,  Train Acc: 41.41%,  Val Loss:  1.52,  Val Acc: 38.30%,  Val Auc:    0.0,  Time: 0:01:40 *
2020-05-25 13:53:36,124 Iter:    600,  Train Loss:   1.5,  Train Acc: 39.84%,  Val Loss:  1.51,  Val Acc: 38.39%,  Val Auc:    0.0,  Time: 0:01:57 *
2020-05-25 13:53:53,397 Iter:    700,  Train Loss:  1.46,  Train Acc: 41.41%,  Val Loss:  1.49,  Val Acc: 39.79%,  Val Auc:    0.0,  Time: 0:02:14 *
2020-05-25 13:54:10,707 Iter:    800,  Train Loss:  1.62,  Train Acc: 37.50%,  Val Loss:  1.47,  Val Acc: 40.05%,  Val Auc:    0.0,  Time: 0:02:31 *
2020-05-25 13:54:27,967 Iter:    900,  Train Loss:  1.46,  Train Acc: 40.62%,  Val Loss:  1.46,  Val Acc: 40.54%,  Val Auc:    0.0,  Time: 0:02:49 *
2020-05-25 13:54:45,052 Iter:   1000,  Train Loss:  1.43,  Train Acc: 44.53%,  Val Loss:  1.45,  Val Acc: 40.80%,  Val Auc:    0.0,  Time: 0:03:06 *
2020-05-25 13:55:02,825 Iter:   1100,  Train Loss:  1.46,  Train Acc: 44.53%,  Val Loss:  1.44,  Val Acc: 41.12%,  Val Auc:    0.0,  Time: 0:03:23 *
2020-05-25 13:55:20,080 Iter:   1200,  Train Loss:  1.39,  Train Acc: 43.75%,  Val Loss:  1.43,  Val Acc: 41.59%,  Val Auc:    0.0,  Time: 0:03:41 *
2020-05-25 13:55:37,067 Iter:   1300,  Train Loss:  1.33,  Train Acc: 46.88%,  Val Loss:  1.42,  Val Acc: 41.86%,  Val Auc:    0.0,  Time: 0:03:58 *
2020-05-25 13:55:53,910 Iter:   1400,  Train Loss:  1.43,  Train Acc: 44.53%,  Val Loss:  1.42,  Val Acc: 42.20%,  Val Auc:    0.0,  Time: 0:04:14 *
2020-05-25 13:56:10,992 Iter:   1500,  Train Loss:  1.41,  Train Acc: 42.97%,  Val Loss:  1.41,  Val Acc: 42.40%,  Val Auc:    0.0,  Time: 0:04:32 *
2020-05-25 13:56:28,146 Iter:   1600,  Train Loss:  1.51,  Train Acc: 44.53%,  Val Loss:  1.41,  Val Acc: 42.73%,  Val Auc:    0.0,  Time: 0:04:49 *
2020-05-25 13:56:44,761 Iter:   1700,  Train Loss:  1.39,  Train Acc: 49.22%,  Val Loss:   1.4,  Val Acc: 42.62%,  Val Auc:    0.0,  Time: 0:05:05 *
2020-05-25 13:57:01,302 Iter:   1800,  Train Loss:  1.36,  Train Acc: 40.62%,  Val Loss:   1.4,  Val Acc: 42.74%,  Val Auc:    0.0,  Time: 0:05:22 *
2020-05-25 13:57:18,248 Iter:   1900,  Train Loss:  1.47,  Train Acc: 46.09%,  Val Loss:   1.4,  Val Acc: 43.07%,  Val Auc:    0.0,  Time: 0:05:39 *
2020-05-25 13:57:35,205 Iter:   2000,  Train Loss:  1.35,  Train Acc: 36.72%,  Val Loss:  1.39,  Val Acc: 43.09%,  Val Auc:    0.0,  Time: 0:05:56 *
2020-05-25 13:57:49,226 Iter:   2100,  Train Loss:  1.38,  Train Acc: 36.72%,  Val Loss:  1.39,  Val Acc: 43.04%,  Val Auc:    0.0,  Time: 0:06:10 
2020-05-25 13:58:05,440 Iter:   2200,  Train Loss:  1.35,  Train Acc: 48.44%,  Val Loss:  1.38,  Val Acc: 43.14%,  Val Auc:    0.0,  Time: 0:06:26 *
2020-05-25 13:58:22,812 Iter:   2300,  Train Loss:  1.43,  Train Acc: 42.19%,  Val Loss:  1.38,  Val Acc: 43.46%,  Val Auc:    0.0,  Time: 0:06:43 *
2020-05-25 13:58:39,939 Iter:   2400,  Train Loss:  1.28,  Train Acc: 45.31%,  Val Loss:  1.38,  Val Acc: 43.78%,  Val Auc:    0.0,  Time: 0:07:00 *
2020-05-25 13:58:54,034 Iter:   2500,  Train Loss:  1.31,  Train Acc: 47.66%,  Val Loss:  1.38,  Val Acc: 43.56%,  Val Auc:    0.0,  Time: 0:07:15 
2020-05-25 13:59:11,026 Iter:   2600,  Train Loss:  1.33,  Train Acc: 45.31%,  Val Loss:  1.38,  Val Acc: 43.78%,  Val Auc:    0.0,  Time: 0:07:32 *
2020-05-25 13:59:28,254 Iter:   2700,  Train Loss:  1.52,  Train Acc: 32.03%,  Val Loss:  1.37,  Val Acc: 43.79%,  Val Auc:    0.0,  Time: 0:07:49 *
2020-05-25 13:59:44,986 Iter:   2800,  Train Loss:  1.46,  Train Acc: 39.06%,  Val Loss:  1.37,  Val Acc: 44.26%,  Val Auc:    0.0,  Time: 0:08:06 *
2020-05-25 14:00:01,928 Iter:   2900,  Train Loss:   1.4,  Train Acc: 44.53%,  Val Loss:  1.36,  Val Acc: 44.25%,  Val Auc:    0.0,  Time: 0:08:22 *
2020-05-25 14:00:19,343 Iter:   3000,  Train Loss:  1.22,  Train Acc: 48.44%,  Val Loss:  1.36,  Val Acc: 44.27%,  Val Auc:    0.0,  Time: 0:08:40 *
2020-05-25 14:00:36,354 Iter:   3100,  Train Loss:  1.42,  Train Acc: 39.06%,  Val Loss:  1.36,  Val Acc: 44.43%,  Val Auc:    0.0,  Time: 0:08:57 *
2020-05-25 14:00:53,297 Iter:   3200,  Train Loss:  1.33,  Train Acc: 45.31%,  Val Loss:  1.36,  Val Acc: 44.71%,  Val Auc:    0.0,  Time: 0:09:14 *
2020-05-25 14:01:10,117 Iter:   3300,  Train Loss:  1.37,  Train Acc: 42.97%,  Val Loss:  1.35,  Val Acc: 44.33%,  Val Auc:    0.0,  Time: 0:09:31 *
2020-05-25 14:01:27,878 Iter:   3400,  Train Loss:  1.31,  Train Acc: 50.78%,  Val Loss:  1.35,  Val Acc: 44.63%,  Val Auc:    0.0,  Time: 0:09:48 *
2020-05-25 14:01:42,013 Iter:   3500,  Train Loss:  1.24,  Train Acc: 47.66%,  Val Loss:  1.35,  Val Acc: 44.61%,  Val Auc:    0.0,  Time: 0:10:03 
2020-05-25 14:01:55,767 Iter:   3600,  Train Loss:   1.4,  Train Acc: 48.44%,  Val Loss:  1.35,  Val Acc: 44.74%,  Val Auc:    0.0,  Time: 0:10:16 
2020-05-25 14:02:09,545 Iter:   3700,  Train Loss:  1.29,  Train Acc: 42.97%,  Val Loss:  1.36,  Val Acc: 44.54%,  Val Auc:    0.0,  Time: 0:10:30 
2020-05-25 14:02:26,661 Iter:   3800,  Train Loss:  1.37,  Train Acc: 39.06%,  Val Loss:  1.35,  Val Acc: 44.66%,  Val Auc:    0.0,  Time: 0:10:47 *
2020-05-25 14:02:43,874 Iter:   3900,  Train Loss:  1.32,  Train Acc: 48.44%,  Val Loss:  1.35,  Val Acc: 44.67%,  Val Auc:    0.0,  Time: 0:11:04 *
2020-05-25 14:03:00,627 Iter:   4000,  Train Loss:  1.32,  Train Acc: 44.53%,  Val Loss:  1.34,  Val Acc: 44.96%,  Val Auc:    0.0,  Time: 0:11:21 *
2020-05-25 14:03:14,763 Iter:   4100,  Train Loss:  1.35,  Train Acc: 46.88%,  Val Loss:  1.35,  Val Acc: 44.82%,  Val Auc:    0.0,  Time: 0:11:35 
2020-05-25 14:03:31,052 Iter:   4200,  Train Loss:  1.34,  Train Acc: 55.47%,  Val Loss:  1.34,  Val Acc: 45.19%,  Val Auc:    0.0,  Time: 0:11:52 *
2020-05-25 14:03:47,930 Iter:   4300,  Train Loss:  1.53,  Train Acc: 45.31%,  Val Loss:  1.34,  Val Acc: 45.14%,  Val Auc:    0.0,  Time: 0:12:08 *
2020-05-25 14:04:04,550 Iter:   4400,  Train Loss:   1.5,  Train Acc: 38.28%,  Val Loss:  1.34,  Val Acc: 45.27%,  Val Auc:    0.0,  Time: 0:12:25 *
2020-05-25 14:04:21,365 Iter:   4500,  Train Loss:   1.5,  Train Acc: 40.62%,  Val Loss:  1.33,  Val Acc: 45.06%,  Val Auc:    0.0,  Time: 0:12:42 *
2020-05-25 14:04:35,938 Iter:   4600,  Train Loss:  1.34,  Train Acc: 43.75%,  Val Loss:  1.34,  Val Acc: 44.79%,  Val Auc:    0.0,  Time: 0:12:56 
2020-05-25 14:04:52,877 Iter:   4700,  Train Loss:  1.39,  Train Acc: 42.19%,  Val Loss:  1.33,  Val Acc: 45.25%,  Val Auc:    0.0,  Time: 0:13:13 *
2020-05-25 14:05:09,739 Iter:   4800,  Train Loss:  1.33,  Train Acc: 49.22%,  Val Loss:  1.33,  Val Acc: 45.20%,  Val Auc:    0.0,  Time: 0:13:30 *
2020-05-25 14:05:26,871 Iter:   4900,  Train Loss:  1.35,  Train Acc: 46.09%,  Val Loss:  1.33,  Val Acc: 45.35%,  Val Auc:    0.0,  Time: 0:13:47 *
2020-05-25 14:05:43,503 Iter:   5000,  Train Loss:  1.42,  Train Acc: 40.62%,  Val Loss:  1.33,  Val Acc: 45.39%,  Val Auc:    0.0,  Time: 0:14:04 *
2020-05-25 14:05:57,477 Iter:   5100,  Train Loss:   1.3,  Train Acc: 43.75%,  Val Loss:  1.33,  Val Acc: 45.39%,  Val Auc:    0.0,  Time: 0:14:18 
2020-05-25 14:06:14,603 Iter:   5200,  Train Loss:  1.33,  Train Acc: 46.09%,  Val Loss:  1.33,  Val Acc: 45.56%,  Val Auc:    0.0,  Time: 0:14:35 *
2020-05-25 14:06:31,543 Iter:   5300,  Train Loss:  1.38,  Train Acc: 35.16%,  Val Loss:  1.32,  Val Acc: 45.54%,  Val Auc:    0.0,  Time: 0:14:52 *
2020-05-25 14:06:45,483 Iter:   5400,  Train Loss:  1.25,  Train Acc: 55.47%,  Val Loss:  1.33,  Val Acc: 45.51%,  Val Auc:    0.0,  Time: 0:15:06 
2020-05-25 14:07:01,950 Iter:   5500,  Train Loss:  1.31,  Train Acc: 48.44%,  Val Loss:  1.32,  Val Acc: 45.38%,  Val Auc:    0.0,  Time: 0:15:23 *
2020-05-25 14:07:19,188 Iter:   5600,  Train Loss:  1.34,  Train Acc: 43.75%,  Val Loss:  1.32,  Val Acc: 45.55%,  Val Auc:    0.0,  Time: 0:15:40 *
2020-05-25 14:07:36,032 Iter:   5700,  Train Loss:  1.16,  Train Acc: 54.69%,  Val Loss:  1.32,  Val Acc: 45.62%,  Val Auc:    0.0,  Time: 0:15:57 *
2020-05-25 14:07:50,112 Iter:   5800,  Train Loss:  1.37,  Train Acc: 48.44%,  Val Loss:  1.32,  Val Acc: 45.75%,  Val Auc:    0.0,  Time: 0:16:11 
2020-05-25 14:08:07,176 Iter:   5900,  Train Loss:  1.23,  Train Acc: 51.56%,  Val Loss:  1.32,  Val Acc: 46.06%,  Val Auc:    0.0,  Time: 0:16:28 *
2020-05-25 14:08:21,816 Iter:   6000,  Train Loss:  1.48,  Train Acc: 39.84%,  Val Loss:  1.32,  Val Acc: 45.96%,  Val Auc:    0.0,  Time: 0:16:42 
2020-05-25 14:08:39,506 Iter:   6100,  Train Loss:  1.28,  Train Acc: 53.12%,  Val Loss:  1.31,  Val Acc: 45.95%,  Val Auc:    0.0,  Time: 0:17:00 *
2020-05-25 14:08:56,969 Iter:   6200,  Train Loss:  1.23,  Train Acc: 52.34%,  Val Loss:  1.31,  Val Acc: 46.17%,  Val Auc:    0.0,  Time: 0:17:18 *
2020-05-25 14:09:11,430 Iter:   6300,  Train Loss:  1.25,  Train Acc: 46.09%,  Val Loss:  1.31,  Val Acc: 45.98%,  Val Auc:    0.0,  Time: 0:17:32 
2020-05-25 14:09:13,495 Epoch [2/5]
2020-05-25 14:09:26,545 Iter:   6400,  Train Loss: 0.943,  Train Acc: 63.28%,  Val Loss:  1.35,  Val Acc: 45.59%,  Val Auc:    0.0,  Time: 0:17:47 
2020-05-25 14:09:40,462 Iter:   6500,  Train Loss:  1.01,  Train Acc: 57.03%,  Val Loss:  1.39,  Val Acc: 44.86%,  Val Auc:    0.0,  Time: 0:18:01 
2020-05-25 14:09:54,282 Iter:   6600,  Train Loss:  1.01,  Train Acc: 65.62%,  Val Loss:  1.45,  Val Acc: 44.22%,  Val Auc:    0.0,  Time: 0:18:15 
2020-05-25 14:10:08,224 Iter:   6700,  Train Loss: 0.971,  Train Acc: 58.59%,  Val Loss:  1.47,  Val Acc: 43.83%,  Val Auc:    0.0,  Time: 0:18:29 
2020-05-25 14:10:21,892 Iter:   6800,  Train Loss:  1.03,  Train Acc: 62.50%,  Val Loss:  1.49,  Val Acc: 42.94%,  Val Auc:    0.0,  Time: 0:18:42 
2020-05-25 14:10:35,652 Iter:   6900,  Train Loss: 0.971,  Train Acc: 62.50%,  Val Loss:   1.5,  Val Acc: 42.86%,  Val Auc:    0.0,  Time: 0:18:56 
2020-05-25 14:10:50,233 Iter:   7000,  Train Loss:  1.07,  Train Acc: 57.81%,  Val Loss:  1.51,  Val Acc: 42.90%,  Val Auc:    0.0,  Time: 0:19:11 
2020-05-25 14:11:03,953 Iter:   7100,  Train Loss:  0.95,  Train Acc: 61.72%,  Val Loss:  1.53,  Val Acc: 42.48%,  Val Auc:    0.0,  Time: 0:19:25 
2020-05-25 14:11:17,955 Iter:   7200,  Train Loss: 0.945,  Train Acc: 59.38%,  Val Loss:  1.51,  Val Acc: 42.75%,  Val Auc:    0.0,  Time: 0:19:39 
2020-05-25 14:11:31,828 Iter:   7300,  Train Loss:  1.06,  Train Acc: 61.72%,  Val Loss:   1.5,  Val Acc: 43.00%,  Val Auc:    0.0,  Time: 0:19:52 
2020-05-25 14:11:45,771 Iter:   7400,  Train Loss: 0.932,  Train Acc: 64.84%,  Val Loss:  1.51,  Val Acc: 42.81%,  Val Auc:    0.0,  Time: 0:20:06 
2020-05-25 14:12:00,024 Iter:   7500,  Train Loss:  1.07,  Train Acc: 56.25%,  Val Loss:   1.5,  Val Acc: 43.08%,  Val Auc:    0.0,  Time: 0:20:21 
2020-05-25 14:12:14,983 Iter:   7600,  Train Loss:   1.0,  Train Acc: 64.84%,  Val Loss:   1.5,  Val Acc: 42.63%,  Val Auc:    0.0,  Time: 0:20:36 
2020-05-25 14:12:28,908 Iter:   7700,  Train Loss: 0.995,  Train Acc: 64.84%,  Val Loss:  1.52,  Val Acc: 42.59%,  Val Auc:    0.0,  Time: 0:20:49 
2020-05-25 14:12:42,601 Iter:   7800,  Train Loss: 0.989,  Train Acc: 67.19%,  Val Loss:  1.52,  Val Acc: 42.42%,  Val Auc:    0.0,  Time: 0:21:03 
2020-05-25 14:12:56,517 Iter:   7900,  Train Loss:  1.15,  Train Acc: 54.69%,  Val Loss:  1.52,  Val Acc: 42.45%,  Val Auc:    0.0,  Time: 0:21:17 
2020-05-25 14:13:10,982 Iter:   8000,  Train Loss:  1.01,  Train Acc: 60.16%,  Val Loss:  1.52,  Val Acc: 42.37%,  Val Auc:    0.0,  Time: 0:21:32 
2020-05-25 14:13:25,005 Iter:   8100,  Train Loss:  1.09,  Train Acc: 61.72%,  Val Loss:  1.51,  Val Acc: 42.10%,  Val Auc:    0.0,  Time: 0:21:46 
2020-05-25 14:13:38,856 Iter:   8200,  Train Loss:  1.11,  Train Acc: 52.34%,  Val Loss:   1.5,  Val Acc: 42.15%,  Val Auc:    0.0,  Time: 0:21:59 
2020-05-25 14:13:38,856 No optimization for a long time, auto-stopping...
2020-05-25 14:13:49,683 Test Loss:   1.3,  Test Acc: 46.17%, Test Auc:    0.0
2020-05-25 14:13:49,684 Precision, Recall and F1-Score...
2020-05-25 14:13:49,684              precision    recall  f1-score   support

          0     0.7160    0.4982    0.5875      3543
          1     0.6069    0.6075    0.6072     15016
          2     0.4668    0.6062    0.5275     20342
          3     0.4584    0.3890    0.4209     14981
          4     0.3589    0.3179    0.3371     13125
          5     0.3541    0.4318    0.3891     10231
          6     0.4136    0.2428    0.3060      6492
          7     0.4454    0.2711    0.3370      3217
          8     0.3892    0.4060    0.3975      1926
          9     0.4562    0.6051    0.5202      1127

avg / total     0.4636    0.4617    0.4562     90000

2020-05-25 14:13:49,684 Confusion Matrix...
2020-05-25 14:13:49,684 [[ 1765  1231   378    32    36    42    25     8     8    18]
 [  385  9122  4580   413   228   159    46    15    26    42]
 [  119  3501 12332  2784   960   425    82    40    40    59]
 [   43   642  5123  5828  2380   687   124    43    54    57]
 [   42   272  2210  2490  4172  3295   360    90   105    89]
 [   37   148   924   773  2662  4418   883   163   139    84]
 [   34    68   448   249   900  2449  1576   474   215    79]
 [   25    28   232    77   206   674   543   872   446   114]
 [    7    13   123    48    65   243   147   227   782   271]
 [    8     5    67    21    17    83    24    26   194   682]]
2020-05-25 14:13:49,685 Time usage: 0:00:10
2020-05-25 14:13:49,685 ALL Time usage: 0:23:48
